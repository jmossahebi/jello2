<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Trello Clone</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css?v=6" />
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js?v=6"></script>
  </head>
  <body>
    <!-- Auth screen: hidden by default when skip-login is on; JS shows it when auth is required -->
    <div id="auth-screen" class="auth-screen hidden">
      <div class="auth-container">
        <div class="auth-tabs">
          <button type="button" id="auth-tab-signin" class="auth-tab active">Sign in</button>
          <button type="button" id="auth-tab-signup" class="auth-tab">Sign up</button>
        </div>

        <div id="login-screen" class="auth-panel">
          <div class="auth-header">
            <h1>Sign in</h1>
          </div>
          <form class="auth-form" id="login-form" onsubmit="return false;">
            <label class="field">
              <span class="field-label">Email</span>
              <input id="login-email-input" class="field-input" type="email" placeholder="you@example.com" autocomplete="email" />
            </label>
            <label class="field">
              <span class="field-label">Password</span>
              <div class="password-field-wrapper">
                <input id="login-password-input" class="field-input" type="password" placeholder="••••••••" autocomplete="current-password" />
                <button type="button" class="password-toggle-btn" data-target="login-password-input" aria-label="Show password">Show</button>
              </div>
            </label>
            <p class="auth-forgot-row">
              <button type="button" id="forgot-password-btn" class="btn-link auth-forgot-btn">Forgot password?</button>
            </p>
            <div id="login-error" class="auth-error hidden"></div>
            <button type="button" id="login-btn" class="btn btn-primary">Sign in</button>
          </form>
        </div>

        <div id="register-screen" class="auth-panel hidden">
          <div class="auth-header">
            <h1>Create account</h1>
          </div>
          <form class="auth-form" id="register-form" onsubmit="return false;">
            <label class="field">
              <span class="field-label">Email</span>
              <input id="register-email-input" class="field-input" type="email" placeholder="you@example.com" autocomplete="email" />
            </label>
            <label class="field">
              <span class="field-label">Password</span>
              <div class="password-field-wrapper">
                <input id="register-password-input" class="field-input" type="password" placeholder="••••••••" autocomplete="new-password" />
                <button type="button" class="password-toggle-btn" data-target="register-password-input" aria-label="Show password">Show</button>
              </div>
            </label>
            <label class="field">
              <span class="field-label">Confirm password</span>
              <div class="password-field-wrapper">
                <input id="register-confirm-password-input" class="field-input" type="password" placeholder="••••••••" autocomplete="new-password" />
                <button type="button" class="password-toggle-btn" data-target="register-confirm-password-input" aria-label="Show password">Show</button>
              </div>
            </label>
            <div id="register-error" class="auth-error hidden"></div>
            <button type="button" id="register-btn" class="btn btn-primary">Sign up</button>
          </form>
        </div>
      </div>
    </div>

    <!-- App content (Kanban board) - visible by default; JS hides and shows auth when login is required -->
    <div class="app" id="app-content">
      <div class="world-clock-container" id="world-clock-container">
        <div class="world-clock-header">
          <span class="world-clock-title">World Clock</span>
          <button type="button" class="btn btn-ghost world-clock-toggle-btn" id="world-clock-hide-btn" title="Hide world clock">− Hide</button>
        </div>
        <div class="world-clock-clocks" id="world-clock-clocks">
          <!-- Clocks will be injected by JavaScript -->
        </div>
      </div>
      <div class="world-clock-show-bar hidden" id="world-clock-show-bar">
        <button type="button" class="btn btn-ghost world-clock-show-btn" id="world-clock-show-btn" title="Show world clock">Show World Clock</button>
      </div>
      <header class="app-header">
        <div class="app-header-left">
          <div class="app-logo">Kanban</div>
          <div class="app-header-board-name" id="current-board-name"></div>
        </div>
        <div class="app-header-right">
          <div class="pomodoro-widget" id="pomodoro-widget">
            <span class="pomodoro-phase" id="pomodoro-phase">Focus</span>
            <span class="pomodoro-time" id="pomodoro-time">25:00</span>
            <div class="pomodoro-actions">
              <button type="button" class="btn btn-secondary pomodoro-btn" id="pomodoro-start-pause" title="Start / Pause">Play</button>
              <button type="button" class="btn btn-ghost pomodoro-btn" id="pomodoro-reset" title="Reset">Reset</button>
              <button type="button" class="btn btn-ghost pomodoro-btn" id="pomodoro-settings-btn" title="Customise work & rest time">Settings</button>
            </div>
          </div>
          <select id="board-select" class="board-select"></select>
          <div class="backup-controls">
            <button id="backup-folder-btn" class="btn btn-secondary" title="Select backup folder">Backup Folder</button>
            <span id="backup-status" class="backup-status" title="Backup status"></span>
          </div>
          <button id="export-btn" class="btn btn-secondary" title="Export all boards">Export</button>
          <button id="import-btn" class="btn btn-secondary" title="Import boards from file">Import</button>
          <input type="file" id="import-file-input" accept=".json" style="display: none;" />
          <button id="email-settings-btn" class="btn btn-secondary" title="Configure email settings">Email Settings</button>
          <button id="transcript-btn" class="btn btn-secondary" title="Import transcript and create cards">Transcript</button>
          <button id="settings-btn" class="btn btn-secondary" title="Settings">Settings</button>
          <button id="add-board-btn" class="btn btn-secondary">+ New board</button>
          <div class="user-info">
            <span id="user-email-display" class="user-email"></span>
            <button id="logout-btn" class="btn btn-secondary" title="Logout">Logout</button>
          </div>
        </div>
      </header>

      <div class="filter-bar hidden" id="filter-bar">
        <span class="filter-bar-label">Filter by tags:</span>
        <div class="filter-tags" id="filter-tags-container"></div>
        <button type="button" class="btn btn-ghost filter-clear-btn hidden" id="filter-clear-btn">Clear filter</button>
      </div>

      <main class="board-container" id="board-container">
        <!-- Lists injected by JS -->
      </main>
    </div>

    <!-- Dialog Backdrop -->
    <div class="modal-backdrop hidden" id="modal-backdrop"></div>

    <!-- Add / Edit Board Modal -->
    <div class="modal hidden" id="board-modal">
      <div class="modal-content">
        <h2 id="board-modal-title">New board</h2>
        <label class="field">
          <span class="field-label">Board name</span>
          <input id="board-name-input" class="field-input" type="text" placeholder="e.g. Product roadmap" />
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="board-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="board-save-btn">Save</button>
        </div>
      </div>
    </div>

    <!-- Add / Edit List Modal -->
    <div class="modal hidden" id="list-modal">
      <div class="modal-content">
        <h2 id="list-modal-title">New list</h2>
        <label class="field">
          <span class="field-label">List title</span>
          <input id="list-title-input" class="field-input" type="text" placeholder="e.g. To do" />
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="list-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="list-save-btn">Save</button>
        </div>
      </div>
    </div>

    <!-- Add / Edit Card Modal -->
    <div class="modal hidden" id="card-modal">
      <div class="modal-content">
        <h2 id="card-modal-title">New card</h2>
        <label class="field">
          <span class="field-label">Title</span>
          <input id="card-title-input" class="field-input" type="text" placeholder="Card title" />
        </label>
        <label class="field">
          <span class="field-label">Description</span>
          <textarea
            id="card-description-input"
            class="field-input field-textarea"
            rows="4"
            placeholder="Optional details"
          ></textarea>
        </label>
        <label class="field">
          <span class="field-label">Priority</span>
          <select id="card-priority-input" class="field-input field-select">
            <option value="p0">P0 — Critical</option>
            <option value="p1">P1 — High</option>
            <option value="p2">P2 — Medium</option>
            <option value="p3">P3 — Low</option>
            <option value="p4">P4 — Lowest</option>
          </select>
        </label>
        <label class="field">
          <span class="field-label">Tags</span>
          <div id="card-tags-chips" class="tags-chips"></div>
          <input id="card-tag-input" class="field-input" type="text" placeholder="Type a tag and press Enter" />
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="card-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="card-save-btn">Save</button>
        </div>
      </div>
    </div>

    <!-- Email Task Modal -->
    <div class="modal hidden" id="email-modal">
      <div class="modal-content">
        <h2 id="email-modal-title">Email Task</h2>
        <label class="field">
          <span class="field-label">Recipient Email</span>
          <input id="email-recipient-input" class="field-input" type="email" placeholder="recipient@example.com" />
        </label>
        <div class="field">
          <span class="field-label">Task Details</span>
          <div class="email-preview">
            <div class="email-preview-item">
              <strong>Title:</strong> <span id="email-preview-title"></span>
            </div>
            <div class="email-preview-item">
              <strong>Priority:</strong> <span id="email-preview-priority"></span>
            </div>
            <div class="email-preview-item">
              <strong>Description:</strong> <span id="email-preview-description"></span>
            </div>
            <div class="email-preview-item">
              <strong>List:</strong> <span id="email-preview-list"></span>
            </div>
            <div class="email-preview-item">
              <strong>Board:</strong> <span id="email-preview-board"></span>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="email-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="email-send-btn">Open Email Client</button>
        </div>
      </div>
    </div>

    <!-- Transcript Modal -->
    <div class="modal hidden" id="transcript-modal">
      <div class="modal-content">
        <h2 id="transcript-modal-title">Import Transcript</h2>
        <label class="field">
          <span class="field-label">Paste your audio transcript here</span>
          <textarea
            id="transcript-input"
            class="field-input field-textarea"
            rows="10"
            placeholder="Paste transcript text here. Gemini will analyze it and create cards automatically."
          ></textarea>
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="transcript-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="transcript-process-btn">Create Cards</button>
        </div>
      </div>
    </div>

    <!-- Pomodoro Settings Modal -->
    <div class="modal hidden" id="pomodoro-modal">
      <div class="modal-content">
        <h2>Pomodoro Timer</h2>
        <label class="field">
          <span class="field-label">Work duration (minutes)</span>
          <input id="pomodoro-work-minutes" class="field-input" type="number" min="1" max="60" value="25" />
        </label>
        <label class="field">
          <span class="field-label">Rest duration (minutes)</span>
          <input id="pomodoro-rest-minutes" class="field-input" type="number" min="0" max="30" value="5" />
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="pomodoro-modal-cancel">Cancel</button>
          <button class="btn btn-primary" id="pomodoro-modal-save">Save</button>
        </div>
      </div>
    </div>

    <!-- Reset Password Modal -->
    <div class="modal hidden" id="reset-password-modal">
      <div class="modal-content">
        <h2>Reset password</h2>
        <p class="field-hint">Enter your email and we'll send you a link to reset your password.</p>
        <label class="field">
          <span class="field-label">Email</span>
          <input id="reset-password-email-input" class="field-input" type="email" placeholder="you@example.com" autocomplete="email" />
        </label>
        <div id="reset-password-message" class="auth-error hidden"></div>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="reset-password-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="reset-password-send-btn">Send reset link</button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal hidden" id="settings-modal">
      <div class="modal-content">
        <h2 id="settings-modal-title">Settings</h2>
        <label class="field">
          <span class="field-label">Gemini API Key</span>
          <input id="gemini-api-key-input" class="field-input" type="password" placeholder="Enter your Gemini API key" />
          <span class="field-hint">
            Get your API key from <a href="https://makersuite.google.com/app/apikey" target="_blank" class="link-accent">Google AI Studio</a>
          </span>
        </label>
        <div class="modal-actions">
          <button class="btn btn-ghost" id="settings-cancel-btn">Cancel</button>
          <button class="btn btn-primary" id="settings-save-btn">Save</button>
        </div>
      </div>
    </div>

    <footer class="app-version" id="app-version" aria-hidden="true">v0.2</footer>

    <script src="main.js?v=6"></script>
  </body>
</html>


